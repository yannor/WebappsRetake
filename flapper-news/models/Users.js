var mongoose=require("mongoose"),crypto=require("crypto"),jwt=require("jsonwebtoken"),UserSchema=new mongoose.Schema({username:{type:String,lowercase:!0,unique:!0},hash:String,salt:String});UserSchema.methods.generateJWT=function(){var a=new Date,b=new Date(a);return b.setDate(a.getDate()+60),jwt.sign({_id:this._id,username:this.username,exp:parseInt(b.getTime()/1e3)},"SECRET")},UserSchema.methods.setPassword=function(a){this.salt=crypto.randomBytes(16).toString("hex"),this.hash=crypto.pbkdf2Sync(a,this.salt,1e3,64).toString("hex")},UserSchema.methods.validPassword=function(a){var b=crypto.pbkdf2Sync(a,this.salt,1e3,64).toString("hex");return this.hash===b},mongoose.model("User",UserSchema);